<div class="col pc:row start-start h-12/12 w-12/12">
  <v-new class="full" src="./monaco_editor.html" props="$hook.editorProps">
    <div loading class="full col center-center c-gray-700 bg-gray-100 fs-sm">
      Loading Editor...
    </div>
  </v-new>
  <v-show runner value="!$hook.props.hiddenView" class="full pl-sm  overflow-auto mini-scrollbar">
  </v-show>
</div>
<script>
  $hook.editorProps = {
    setValue: (cb) => {
      cb();
    },
    onChange: (code) => {
      if (!$hook.props["hiddenView"]) {
        const el = $hook.el.querySelector("[runner]");
        const name = $verk.uuid()
        window[name] = {};
        code = code.replace(/(\$hook|verk-)/g, name);
        const tmp = document.createElement('div');
        try {
          tmp.innerHTML = code;
        } catch (err) { }

        if (tmp.querySelector('script[src]')) {
          tmp.querySelectorAll('script[src]').forEach(e => {
            document.head.append(e.cloneNode(true))
          })
        }

        try {
          tmp.querySelectorAll('script:not([src])').forEach(e => {
            eval(e.innerHTML);
          });
          el.innerHTML = code;
        } catch (err) {

        }

      }
    },
    options: {
      value: "<div>hello</div>",
      language: "html",
      ...$hook.props.options,
    },
    onMount: (editor) => {
      if ($hook.props.getValue) {
        Promise.resolve($hook.props.getValue).then(function (v) {
          editor.setValue(v);
        });
      } else {
        const v = $hook.editorProps.options.value;
        editor.setValue(v);
      }
    }
  };
</script>