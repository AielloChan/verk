!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).$verk=t()}(this,function(){"use strict";for(var e=["$target","$el","$value","$event","$props","$renderState"],t="",n=0;n<8;n++)e.push("$"+t+"v"),e.push("$"+t+"i"),t+="_";function r(e,t,n,r){e.hasAttribute(n)&&t(e),e.querySelectorAll(r).forEach(t)}e.forEach(function(e){void 0===window[e]&&(window[e]="")});var o=0;function y(e){return void 0===e&&(e="u"),999<(o+=1)&&(o=0),e+Date.now().toString().slice(5,13)+(o+"")}function i(n,r){var o,i,u,c=new Set,a=new Set;return u=r?(i=setTimeout,clearTimeout):(i=requestAnimationFrame,cancelAnimationFrame),function(e,t){c.has(e)||c.add(e),t&&!a.has(t)&&a.add(t),o&&u(o),o=i(function(){o=null,c.forEach(n),c.clear(),a.forEach(function(e){e()}),a.clear()},r)}}window.$uuid=y;var u=[];function w(t,n,r){console.error(t,n),u.forEach(function(e){e(t,n,r||"")})}var c=/^v-on/;function a(e){function t(o){o.__events||(o.getAttribute("verk-on").split(" ").forEach(function(e){var n=e.replace("v-","");if(c.test(e)){var r=new Function("$el","$event","return "+o.getAttribute(e));o[n]=function(e){var t;o.getAttribute("prevent-"+n)&&e.preventDefault(),o.getAttribute("stop-"+n)&&e.stopPropagation();try{t=r(o,e)}catch(e){w(e,o)}"function"==typeof t&&t(e),A(o.getAttribute("v-query"))}}}),o.__events=!0)}e.getAttribute("verk-on")&&t(e),e.querySelectorAll("[verk-on]").forEach(t)}function l(i,u,c,a){return new(c=c||Promise)(function(e,t){function n(e){try{o(a.next(e))}catch(e){t(e)}}function r(e){try{o(a.throw(e))}catch(e){t(e)}}function o(t){t.done?e(t.value):new c(function(e){e(t.value)}).then(n,r)}o((a=a.apply(i,u||[])).next())})}function g(n,r){var o,i,u,e,c={label:0,sent:function(){if(1&u[0])throw u[1];return u[1]},trys:[],ops:[]};return e={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(o)throw new TypeError("Generator is already executing.");for(;c;)try{if(o=1,i&&(u=2&t[0]?i.return:t[0]?i.throw||((u=i.return)&&u.call(i),0):i.next)&&!(u=u.call(i,t[1])).done)return u;switch(i=0,u&&(t=[2&t[0],u.value]),t[0]){case 0:case 1:u=t;break;case 4:return c.label++,{value:t[1],done:!1};case 5:c.label++,i=t[1],t=[0];continue;case 7:t=c.ops.pop(),c.trys.pop();continue;default:if(!(u=0<(u=c.trys).length&&u[u.length-1])&&(6===t[0]||2===t[0])){c=0;continue}if(3===t[0]&&(!u||t[1]>u[0]&&t[1]<u[3])){c.label=t[1];break}if(6===t[0]&&c.label<u[1]){c.label=u[1],u=t;break}if(u&&c.label<u[2]){c.label=u[2],c.ops.push(t);break}u[2]&&c.ops.pop(),c.trys.pop();continue}t=r.call(n,c)}catch(e){t=[6,e],i=0}finally{o=u=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}}var f=new RegExp('src="./',"g"),s=new RegExp('href="./',"g"),_={},E={},v={};function $(o,i){return l(this,void 0,void 0,function(){var n,r,t;return g(this,function(e){switch(e.label){case 0:return n=[],r=[],o.querySelectorAll(i).forEach(function(e){var t=document.createElement("script");t.setAttribute("src",e.getAttribute("src")),n.push(t),r.push(new Promise(function(e){return t.onload=e})),e.remove()}),0<n.length?((t=document.head).append.apply(t,n),[4,Promise.all(r)]):[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})}function d(e){e.querySelectorAll("template[v-component]").forEach(function(o){return l(this,void 0,void 0,function(){var t,n,r;return g(this,function(e){return!(t=o.getAttribute("v-component"))||_[t]||((n=document.createElement("div")).innerHTML=o.innerHTML,(r=n.querySelector("script:not([src])"))&&(E[t]=new Function("$parent","$id","$props","$ref","$refs",r.innerHTML),r.remove(),o.remove()),_[t]=n.innerHTML),[2]})})})}function q(t){var e=t.getAttribute("v-if");if(e){var n=void 0;try{n=new Function("return "+e)()}catch(e){w(e,t)}if(!n)return!1}var r=t.getAttribute("v-route");if(r&&1!==(location.hash||"/").indexOf(r))return!1;return!0}function h(e){e.querySelectorAll("template[v-by]:not([uuid])").forEach(function(A){return l(this,void 0,void 0,function(){function t(e){return document.body.querySelector("["+h[e]+"]")}function n(e){return document.body.querySelectorAll("["+h[e]+"]")}var r,o,i,u,c,a,l,f,s,v,d,h,m,p,b;return g(this,function(e){switch(e.label){case 0:if(!(r=A.getAttribute("v-by")))return[2];if(!q(A))return[2];if((o=A.content.querySelector("[v-loading]:not([use-loading])"))&&(i=y(),o.setAttribute("use-loading",i),(u=o.cloneNode(!0)).setAttribute(i,""),A.insertAdjacentElement("afterend",u)),!(c=_[r]))return[2];if(a=A.getAttribute("v-props"),l=y(),s=(f=r+"_"+l)+"_props",A.setAttribute("uuid",f),A.innerHTML=A.innerHTML.replace(/\$renderState/g,f),a)try{window[s]=new Function("return "+a)()}catch(e){w(e,A,a)}else window[s]={};return v=document.createElement("div"),d=(d=(d=c.replace(/\$state/g,f)).replace(/\$id/g,"'"+f+"'")).replace(/\$props/g,s),v.innerHTML=d,v.querySelectorAll("*").forEach(function(e,t){e.setAttribute(f,t+1)}),v.querySelectorAll("slot").forEach(function(e){var t=e.getAttribute("name"),n=A.content.querySelector('[slot="'+t+'"]');n&&(Array.from(e.attributes).forEach(function(e){n.getAttribute(e.name)||n.setAttribute(e.name,e.value)}),v.replaceChild(n.cloneNode(!0),e));var r=A.content.querySelector("script");if(r){var o=void 0;try{o=new Function("$parent","$id",r.innerText)(A.parentElement,f)}catch(e){w(e,r)}o&&(window[s]=o)}}),h={},v.querySelectorAll("[v-ref]").forEach(function(e){var t=e.getAttribute("v-ref");h[t]=f+"_ref_"+t,e.removeAttribute("v-ref"),e.setAttribute(h[t],"1")}),S(v),v.querySelector("[defer]")?[4,$(v,"script[src]:not([defer])")]:[3,6];case 1:return e.sent(),[4,$(v,'script[defer=""]')];case 2:return e.sent(),[4,$(v,'script[defer="1"]')];case 3:return e.sent(),[4,$(v,'script[defer="2"]')];case 4:return e.sent(),[4,$(v,'script[defer="3"]')];case 5:return e.sent(),[3,8];case 6:return[4,$(v,"script[src]")];case 7:e.sent(),e.label=8;case 8:if(m=E[r])try{p=m(A.parentElement,f,window[s],t,n)}catch(e){w(e,A,m)}return(b=A.content.querySelector("[use-loading]"))&&document.body.querySelectorAll("["+b.getAttribute("use-loading")+"]").forEach(function(e){e.remove()}),A.insertAdjacentHTML("afterend",v.innerHTML),Promise.resolve(p).then(function(e){window[f]=e,requestAnimationFrame(function(){L(A.parentElement,function(){window[f]&&window[f].$mount&&window[f].$mount(window[f]),window[s]&&window[s].$mount&&window[s].$mount(window[f])})})}),[2]}})})})}function m(e){!function(i){i.querySelectorAll("template[v-fetch]:not([fetch-loaded])").forEach(function(e){e.setAttribute("fetch-loaded","");var o=e.getAttribute("v-fetch");o&&!v[o]&&(v[o]=!0,fetch(o,{mode:"cors",cache:e.getAttribute("cache")||"no-cache"}).then(function(e){return e.text()}).then(function(e){if(e){var t=document.createElement("div"),n=o.split("/");n.pop();var r=n.join("/")+"/";e=(e=(e=e.replace(f,'src="'+r)).replace(s,'href="'+r)).replace(/\$dir/,"'"+r+"'"),t.innerHTML=e,d(t),requestAnimationFrame(function(){m(i)})}}).catch(function(e){v[o]=!1}))})}(e),d(e),requestAnimationFrame(function(){h(e)})}var p=/^v-(?!if|for|model|show|by|fetch|component|css|watch)/,b=/^v-on/;function S(e){e.querySelectorAll("*").forEach(function(e){if(!e.getAttribute("verk-on")&&!e.getAttribute("verk-attr")){var t="",n="";Array.from(e.attributes).forEach(function(e){b.test(e.name)?n+=e.name+" ":p.test(e.name)&&(t+=e.name+" ")}),t&&e.setAttribute("verk-attr",t.trim()),n&&e.setAttribute("verk-on",n.trim())}})}function A(e){e=e&&"*"!==e?e:"[v-verk]",document.querySelectorAll(e).forEach(function(e){T(e)})}var T=i(function(e){x(e)}),k=[function(e){e.querySelectorAll("template[uuid]").forEach(function(e){var t=e.getAttribute("uuid");t&&(q(e)||(e.removeAttribute("uuid"),document.body.querySelectorAll("["+t+"]").forEach(function(e){e.remove()}),delete window[t],delete window[t+"_props"]))})},h,function(e){r(e,function(t){var e;t.style.display="none";try{"function"==typeof(e=new Function("$el","return "+t.getAttribute("v-if"))(t))&&(e=e())}catch(e){w(e,t)}var n=t.getAttribute("uuid");if(e){if(!n){n=y("if"),t.setAttribute("uuid",n);var r=document.createElement("div");r.innerHTML=t.innerHTML;var o=[];r.querySelectorAll("script").forEach(function(e){o.push(e.innerHTML),e.remove()}),r.querySelectorAll("*").forEach(function(e){e.setAttribute(n,"")}),t.insertAdjacentHTML("afterend",r.innerHTML),o.forEach(function(e){try{new Function(e)()}catch(e){w(e,t)}})}}else n&&(document.body.querySelectorAll("["+n+"]").forEach(function(e){e.remove()}),t.removeAttribute("uuid"))},"v-if","[v-if]:not([v-by])")},function(e){function t(r){if(!r.__forcode){r.__forcode=r.getAttribute("v-for"),r.__html=r.innerHTML;try{r.__forData=new Function("$el","return "+r.__forcode)(r)}catch(e){w(e,r)}}var e=r.__forData;if(e&&r.getAttribute("for-length")!=e.length){var o=r.__html,i="";e.forEach(function(e,t){var n=o.replace(/\$v/g,r.__forcode+"["+t+"]");n=(n=n.replace(/\$i/g,t)).replace(/\$_/g,"$"),i+=n}),r.innerHTML=i,r.setAttribute("for-length",e.length),a(r)}}var n=[],r=e.querySelectorAll("[v-for]"),o=r.length;r.forEach(function(e,t){n[o-t-1]=e}),n.forEach(t),e.hasAttribute("v-for")&&t(e)},function(e){r(e,function(t){var e;try{"function"==typeof(e=new Function("$el","return "+t.getAttribute("v-show"))(t))&&(e=e())}catch(e){w(e,t)}e?t.style.removeProperty("display"):t.style.display="none"},"v-show","[v-show]")},function(e){r(e,function(u){var e,t,c=u.getAttribute("v-model"),a=u.getAttribute("v-query");if(function(e){if(!e.__modelName){var t=e.tagName.toLowerCase(),n=e.type;e.__modelName="select"===t?"onchange":"input"===t||"textarea"===t?"oninput":"onclick","select"===t?e.__valueName="value":"checkbox"===n?(e.__valueName="checked",e.__valueIsBool=!0):"radio"===n?(e.__modelName="onclick",e.__valueName="checked",e.__valueIsBool=!0):e.__valueName="value"}}(u),u.__models||(u[u.__modelName]=function(e){u.getAttribute("prevent-"+u.__modelName)&&e.preventDefault(),u.getAttribute("stop-"+u.__modelName)&&e.stopPropagation();var t,n,r=e.target&&e.target[u.__valueName]||"";if(u.__valueIsBool){var o=u.getAttribute("v-value"),i=u.getAttribute("value");t=o?c+"["+o+"] = !"+c+"["+o+"]; return "+c+"["+o+"];":i?c+"['"+i+"'] = !"+c+"['"+i+"']; return "+c+"['"+i+"'];":c+"="+!!r+"; return "+c+";"}else t=c+"=`"+r+"`; return "+c+";";try{n=new Function("$el",t)(u)}catch(e){w(e,u)}u[u.__valueName]!==n&&(u[u.__valueName]=n),A(a)},u.__models=!0),u.__valueIsBool){var n=u.getAttribute("v-value"),r=u.getAttribute("value");t=r?"return "+c+"['"+r+"']":n?"return "+c+"["+n+"]":"return "+c}else t="return "+c;try{e=new Function(t)()||""}catch(e){w(e,u)}u[u.__valueName]!==e&&requestAnimationFrame(function(){u[u.__valueName]=e})},"v-model","[v-model]")},function(e){r(e,function(t){var e;t.getAttribute("text-save")||t.setAttribute("text-save",t.getAttribute("v-text")||t.textContent);try{"function"==typeof(e=new Function("$el","return "+t.getAttribute("text-save"))(t))&&(e=e())}catch(e){w(e,t)}t.textContent!==e&&(t.textContent=e)},"v-text","[v-text]")},function(e){r(e,function(n){n.getAttribute("verk-attr").split(" ").forEach(function(e){var t;try{"function"==typeof(t=new Function("$el","return "+n.getAttribute(e))(n))&&(t=t())}catch(e){w(e,n)}n.setAttribute(e.replace("v-",""),t)})},"verk-attr","[verk-attr]")},function(e){r(e,function(t){try{var e=new Function("$el",t.getAttribute("v-watch"))(t);"function"==typeof e&&e()}catch(e){w(e,t)}},"v-watch","[v-watch]")}];function x(t){k.forEach(function(e){e(t)})}var F=[m,a],L=i(function(e){function t(t){x(t),F.forEach(function(e){e(t)})}e?t(e):document.querySelectorAll("[v-verk]").forEach(t)}),N={update:L,middlewareByUpdate:k,middlewareByInit:F,Reducer:function(n,r){var o,i,u;return u=r?(i=setTimeout,clearTimeout):(i=requestAnimationFrame,cancelAnimationFrame),function(e,t){o&&u(o),o=i(function(){o=null,n(e),t&&t()},r)}},ReducerList:i};return window.addEventListener("load",function(){document.querySelectorAll("[v-verk]").forEach(function(e){S(e),L(e),setTimeout(function(){"hidden"===e.style.visibility&&(e.style.visibility="visible")},200)})}),N});
